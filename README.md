# Menteetor


- 프로젝트 기간 : 24.01 ~ 24.06
- 프로젝트 인원 : 4명
  - Back-End : 2명
  - Front-End 
    - Android : 1명
    - Web : 1명

---

## 프로젝트 기획의도

> 대학교에 다니면서 학업에 관련하여 모르는 부분이나 궁금한 점이 있을 때 도움을 받을 사람을 찾기 어려운 경우가 많았고
> 이로 인해 같은 단과 내에서 멘토를 구할 수 있으면 학교생활을 하는데에 있어서 많은 도움을 받을 수 있을 것이라 생각했습니다.
> 현재 캠퍼스 내에서 소통하는 커뮤니티 앱은 존재하지만, 학업과 관련된 전문적인 정보를 얻는데는 한계점이 존재한다고 판단하였습니다.
> 간편하고 신속하게 글을 올려 도움을 받을 수 있는 전문적인 커뮤니티가 필요하다고 느꼈고,
> 선배나 졸업생이 자신이 알고 있는 지식을 후배들과 소통하는 플랫폼이 있었으면 좋겠다는 생각도 들었습니다. 
> 또한, 본인이 다니는 학교에 국한되지 않고 같은 전공을 가진 다른 학교의 학생들과도 교류할 수 있다면 성장 과정에 큰 도움이 될 것 같아 해당 프로젝트를 기획하게 되었습니다.

---

## 프로젝트 기능

- 이용자는 모든 학교별 / 자신의 학교별에 따라 서비스를 이용할 수 있다.

- 이용자가 멘토가 되길 원할 경우 멘티 모집에 대한 과목, 조건등이 포함된 글을 작성한다. 

- 이용자가 멘티 모집 글에 신청 양식을 작성하고, 멘토는 신청 요청이 온 글을 보고 매칭여부를 결정한다.

- 매칭이 성사될 경우 실시간 채팅을 통해 멘토와 멘티간의 실시간 상담이 이어진다.

- 이용자는 질문 게시판을 통해 질문글을 올릴수 있으며 댓글을 통해 소통을 할 수 있다.

- 이용자는 멘티 모집 글에 신청 양식을 작성한다.
  
- 멘토는 신청 요청에 대한 세부 사항을 보고 매칭여부를 결정한다.

- 매칭이 성사될 경우 실시간 채팅을 통해 멘토와 멘티간의 실시간 상담이 이어진다.

- 매칭이 성사된 후 채팅 진행 중 멘티는 멘토에게 상담시간 연장을 신청할 수 있다.
  
- 모든 이용자는 질문 게시판을 통해 질문 글을 올릴수 있으며 댓글을 통해 소통을 할 수 있다.
  
- 모든 이용자는 멘토 요청 게시판을 통해 이러한 멘토가 필요할 것 같다 라는 글을 올릴 수 있으며 댓글을 통해 소통을 할 수 있다.


---

## ERD 

![image](https://github.com/FiveIdiotss/back-end-api/assets/109346159/9e7d163e-0049-48c0-8a85-462c0f12d3d3)

---

## Architecture

![image](https://github.com/FiveIdiotss/back-end-api/assets/109346159/34336d00-09cf-4e10-b35b-0319fd913b92)



---

## 사용 기술
Back-End : <br> 
- <img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white">
- <img src="https://img.shields.io/badge/spring%20security-6DB33F?style=for-the-badge&logo=spring%20security&logoColor=white">
- <img src="https://img.shields.io/badge/json%20web%20tokens-000000?style=for-the-badge&logo=json%20web%20tokens&logoColor=white">
- <img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white">
- <img src="https://img.shields.io/badge/redis-DC382D?style=for-the-badge&logo=redis&logoColor=white">
- <img src="https://img.shields.io/badge/amazon%20ec2-FF9900?style=for-the-badge&logo=amazon%20ec2&logoColor=white">
- <img src="https://img.shields.io/badge/amazon%20rds-527FFF?style=for-the-badge&logo=amazon%20rds&logoColor=white">
- <img src="https://img.shields.io/badge/amazon%20route%2053-8C4FFF?style=for-the-badge&logo=amazon%20route%2053&logoColor=white">
- <img src="https://img.shields.io/badge/nginx-009639?style=for-the-badge&logo=nginx&logoColor=white">
- <img src="https://img.shields.io/badge/swagger-85EA2D?style=for-the-badge&logo=swagger&logoColor=white">


Front-End 웹 :
- <img src="https://img.shields.io/badge/next.js-000000?style=for-the-badge&logo=next.js&logoColor=white">
- <img src="https://img.shields.io/badge/react-61DAFB?style=for-the-badge&logo=react&logoColor=white">
- <img src="https://img.shields.io/badge/react%20query-FF4154?style=for-the-badge&logo=react%20query&logoColor=white">
- <img src="https://img.shields.io/badge/auth.js-EB5424?style=for-the-badge&logo=auth0&logoColor=white">
- <img src="https://img.shields.io/badge/tailwind%20css-06B6D4?style=for-the-badge&logo=tailwind%20css&logoColor=white">
- <img src="https://img.shields.io/badge/zustand-000000?style=for-the-badge&logo=next&logoColor=white">

Front-End 모바일 :
- <img src="https://img.shields.io/badge/databinding-000000?style=for-the-badge&logo=next&logoColor=white">
- <img src="https://img.shields.io/badge/coroutine-000000?style=for-the-badge&logo=jetpack&logoColor=white">
- <img src="https://img.shields.io/badge/flow-000000?style=for-the-badge&logo=jetpack&logoColor=white">



Tools :
- <img src="https://img.shields.io/badge/android%20studio-3DDC84?style=for-the-badge&logo=android%20studio&logoColor=white">
- <img src="https://img.shields.io/badge/visual%20studio%20code%20studio-007ACC?style=for-the-badge&logo=visual%20studio%20code&logoColor=white">
- <img src="https://img.shields.io/badge/intellij%20idea-000000?style=for-the-badge&logo=intellij%20idea&logoColor=white">


Collaboration : 
- <img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">


etc: 
- <img src="https://img.shields.io/badge/docker-2496ED?style=for-the-badge&logo=docker&logoColor=white">
- <img src="https://img.shields.io/badge/firebase%20cloud%20messaging-FFCA28?style=for-the-badge&logo=firebase&logoColor=white">
- <img src="https://img.shields.io/badge/amazon%20s3-569A31?style=for-the-badge&logo=amazon%20s3&logoColor=white">
- <img src="https://img.shields.io/badge/web%20socket-000?style=for-the-badge&logo=alogoColor=white">



---

## 웹 화면 순서도

추가 예정


---

## 모바일 화면 순서도

![img.png](img.png)


---

## 세부 기능


- 🔐 계정

  - 관리자 계정

  - 회원가입

  - 대학교 인증

  - 로그인/로그아웃

  - 소셜 로그인(네이버, 카카오, 구글)

  - 유효성/토큰
  
  - 자동 로그인

  - 비밀번호 변경

- 🏡 메인 게시판

  - 멘티 모집 글 양식에 맞게 작성 

  - 게시글 조회 후 신청

  - 즐겨찾기 

  - 게시판 필터별로 목록 조회 (검색, 즐겨찾기, 날짜, 카테고리, 학교별)

  - 게시판 목록에서 각 게시물에 대한 대표 이미지 보기

  - 무한 스크롤

  - 인기 키워드 제공


- 👤 프로필

  - 프로필 사진 관리

  - 개인정보 관리/수정

  - 자신이 쓴 글 목록

  - 신청/매칭 목록

  - 알림 목록


- 💬 채팅방

  - 멘토, 멘티 매칭 시 실시간 채팅

  - 채팅방 목록
 
  - 각 채팅방에 대한 읽지 않는 메세지 갯수 실시간 카운트 / 조회 시 초기화

  - 채팅 읽음 처리

  - 텍스트 이외에 이미지, 파일 등 전송

  - 채팅방 시간 연장 신청 (중복 연장 신청x)

  - 채팅방 시간 연장 수락/거절



- 🏡 질문 게시판

    - 질문 글 작성

    - 좋아요

    - 댓글

    - 게시판 필터별로 목록 조회

    - 무한 스크롤
      

- 🏡 멘토링 요청 게시판

    - 요청 글 작성

    - 좋아요

    - 댓글

    - 게시판 필터별로 목록 조회

    - 무한 스크롤


- 🔔 알림

    - 채팅, 신청 등에 대한 알림
    
    - 실시간 알림 카운트 / 조회 시 초기화 

- 💸 결제(예정)
  - 코인 충전 
  - 코인 교환
  - 코인 환전
 
---

## 개발과정 

- 각 API에 대한 응답값을 공통으로 처리하기 위해 CommonAPIResponse 클래스를 만들어 해당 api에 성공 여부, 실패 시 오류 메세지, 성공 시 응답 값을 포함해서 FE에 전달

- 이용자가 로그아웃을 했지만 accessToken 은 만료되지 않아 탈취되었을 경우 위험에 대비하여 BlackList Entity 를 추가하여 로그아웃 시 해당 accessToken 을 db에 저장하는 방식 채택

- 처음 알림 서비스기능을 구현할 때 SSE 를 통해 구현하려고 했다. SSE 는 별도의 프로토콜 없이 HTTP 만으로 구현이 가능하며 네트워크 연결이 끊어지면 자동으로 재연결을 시도하며 실시간으로 서버에서 클라이언트로 데이터를 전송할 수 있지만 클라이언트에서 페이지를 닫을때(백그라운드 상태) 서버에서 감지하기 어렵다는 점 때문에 FCM 방식을 채택

- 채팅의 읽음 표시 기능을 구현하기 위해서는 특정 채팅방의 현재 몇 명의 유저가 접속해 있는지를 실시간으로 파악하는 것이 필요했고, 이를 위해 특정 유저가 해당 채팅방을 입장(구독)할 때마다, 실행되는 Inteceptor를 활용하는 것이 적합하다고 판단. Interceptor를 통해 STOMP의 헤더에 담긴 접속하려는 채팅방의 ID 및 유저 ID를 읽어와 Redis에 기록해 해당 채팅방의 접속 유저 정보를 실시간으로 업데이트 할 수 있었음. 

- 채팅방에서 이미지 전송을 위해 이미지 파일을 Base64로 직렬화하여 웹소켓을 통해 전송하는 방식을 사용했지만, 이 방식은 웹소켓을 통한 파일 전송 시 최대 파일 용량 제한, 직렬화 과정의 복잡성, 그리고 다양한 형식의 파일(비디오, 연락처 등) 전송에 부적합하다는 문제점이 존재. 이러한 이유로 HTTP 프로토콜의 multipart/form-data 형식을 사용한 전송 방법을 채택. (메시지는 웹소켓을 통해 전송하고 그 외의 파일들은 HTTP 프로토콜을 통해 전송.)

- Front End의 next.js에 대한 AWS EC2를 따로 생성하려고 했지만 비용적인 측면을 고려해 docker container를 사용하여 하나의 EC2로 Back, Front를 배포하기로 결정

- 무분별하게 사용하는 try-catch 문과 각 부분에 예외처리에 대해 정리가 되어있지 않아 가독성이 떨어졌다. 이때문에 @RestControllerAdvice 어노테이션을 사용해 예외를 효과적으로 처리.   

---
 
## 개선 사항

- 현재 redis 는 pub/sub 기능을 이용하여 실시간 채팅 위주로 사용중이다.
이 프로젝트의 서비스들에 대한 정보는 메인 DB에 모두 저장하는 방식으로 진행하였는데 지금은 서비스 규모가 작기 때문에 별 다른 문제가 발생하고 있지 않고 있지만 채팅내역, FCM 토큰, RefreshToken 등의 정보는 redis 저장소를 이용하여 캐시 처리를 통해 메인 DB에 부담을 줄여주는 방식에 대한 충분한 고려를 통해 서비스를 개발 요망

- 현재 aws ec2 에 spring boot 를 띄워 was 를 사용하고 있는데 보안적인 측면이나 성능 (로드 밸런싱등)에 대한 보완을 위해 nginx 도입을 고려해야 할것 같다.

